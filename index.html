<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>VALTracker</title>

    <script>window.$ = window.jQuery = require('jquery');</script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css" type="text/css">
    <link rel="stylesheet" type="text/css" href="assets/css/global.css">

    <script src="https://kit.fontawesome.com/0fb7a47199.js" crossorigin="anonymous"></script>
  </head>
  <div class="update-banner" style="display: none;">
    <span style="margin-top: 1rem;">An Update has been downloaded. Close the App to install. Dont forget to give permission afterwards!</span>
    <button class="close-app" id="noti-close-button">Close App</button>
    <div class="update-relative-div" id="update-sec">
      <div id="toggle"></div>
    </div>
  </div>
  <div class="download-banner" style="display: none;">
    <span style="margin-top: 1rem;">An Update is being downloaded. Please don't close this Window. You can continue using the app.</span>
    <progress class="download-bar" id="download-bar" max="100" value="0"></progress>
    <div class="download-relative-div" id="download-sec">
      <div id="toggle"></div>
    </div>
  </div>
  <body>
    <header id="titlebar">
      <div id="drag-region">
        <div id="window-title">
          <img class="titlebar-img" src="./icons/VALTracker_logo.ico">
          <span>VALTracker Alpha V0.8.10</span>
        </div>
        <div id="window-controls">

          <div class="button" id="min-button">
            <img class="icon" srcset="icons/min-w-10.png 1x, icons/min-w-12.png 1.25x, icons/min-w-15.png 1.5x, icons/min-w-15.png 1.75x, icons/min-w-20.png 2x, icons/min-w-20.png 2.25x, icons/min-w-24.png 2.5x, icons/min-w-30.png 3x, icons/min-w-30.png 3.5x" draggable="false" />
          </div>
          <div class="button" id="max-button">
            <img class="icon" srcset="icons/max-w-10.png 1x, icons/max-w-12.png 1.25x, icons/max-w-15.png 1.5x, icons/max-w-15.png 1.75x, icons/max-w-20.png 2x, icons/max-w-20.png 2.25x, icons/max-w-24.png 2.5x, icons/max-w-30.png 3x, icons/max-w-30.png 3.5x" draggable="false" />
          </div>
          <div class="button" id="restore-button">
            <img class="icon" srcset="icons/restore-w-10.png 1x, icons/restore-w-12.png 1.25x, icons/restore-w-15.png 1.5x, icons/restore-w-15.png 1.75x, icons/restore-w-20.png 2x, icons/restore-w-20.png 2.25x, icons/restore-w-24.png 2.5x, icons/restore-w-30.png 3x, icons/restore-w-30.png 3.5x" draggable="false" />
          </div>
          <div class="button" id="close-button">
            <img class="icon" srcset="icons/close-w-10.png 1x, icons/close-w-12.png 1.25x, icons/close-w-15.png 1.5x, icons/close-w-15.png 1.75x, icons/close-w-20.png 2x, icons/close-w-20.png 2.25x, icons/close-w-24.png 2.5x, icons/close-w-30.png 3x, icons/close-w-30.png 3.5x" draggable="false" />
          </div>

        </div>
      </div>
    </header>

    <div class="header-relative-div" id="sec" onclick="toggle()">
      <div id="toggle"></div>
    </div>
    <div class="navslide">
      <ul class="navslide-ul-container">
        <li id="home" class="navslide-li color"><span class="" id="home-nav">Home</span></li>
        <li id="psearch" class="navslide-li"><span class="" id="search-nav">Playersearch</span></li>
        <!--<li id="profile" class="navslide-li"><span class="" id="profile-nav">Your Profile</span></li>-->
        <li id="collects" class="collapsible"><span class="" id="collectables-nav"> Collectables</span></li>
        <div class="content">
          <li class="collectables-sub" id="collects-sub-bundles">Bundles</li>
          <li class="collectables-sub" id="collects-sub-skins">Skins</li>
          <li class="collectables-sub" id="collects-sub-buddys">Buddys</li>
          <!--<li class="collectables-sub" id="collects-sub-bps">Battlepasses</li>
          <li class="collectables-sub" id="collects-sub-search">Search</li>-->
        </div>  
        <!--<li id="agents" class="navslide-li"><span class="" id="tools-nav">Agents</span></li>
        <li id="m-n-l" class="navslide-li"><span class="" id="tools-nav">Maps & Lineups</span></li>
        <li id="leads" class="navslide-li"><span class="" id="projects-nav">Leaderboards</span></li>
        <li id="lft" class="navslide-li"><span class="" id="contact-nav">LFT</span></li>-->
      </ul>
    </div>
    <div class="app" id="main-home">
      <div class="pageheader-home">
        <h1 class="user-greetings"></h1>
        <hr class="rotated-sep-home">
        <img class="user-rank-icon" src="assets/img/unranked.png">
        <span class="user-rr-wrapper">RR: <span class="user-rankrating"></span></span>
      </div>
      <div class="absolute-div">
        <div class="slideshow-container">
          <h2 style="margin-top: 0; text-decoration: underline;">Newsfeed</h2>
          <div class="mySlides fade">
            <div class="redirect-to-article" id="link-0" onclick="redirectInDefaultBrowser(this.id, this.textContent)">
              <img src="" style="width:100%; border-radius: 4px;" class="slide-img" id="img-0">
              <div class="text" id="text-0"></div>
              <span style="display: none;" id="hiddenurl-0"></span>
            </div>
          </div>
          <div class="mySlides fade">
            <div class="redirect-to-article" id="link-1" onclick="redirectInDefaultBrowser(this.id, this.textContent)">
              <img src="" style="width:100%; border-radius: 4px;" class="slide-img" id="img-1">
              <div class="text" id="text-1"></div>
              <span style="display: none;" id="hiddenurl-1"></span>
            </div>
          </div>
          <div class="mySlides fade">
            <div class="redirect-to-article" id="link-2" onclick="redirectInDefaultBrowser(this.id, this.textContent)">
              <img src="" style="width:100%; border-radius: 4px;" class="slide-img" id="img-2">
              <div class="text" id="text-2"></div>
              <span style="display: none;" id="hiddenurl-2"></span>
            </div>
          </div>
          <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
          <a class="next" onclick="plusSlides(1)">&#10095;</a>
        </div>
      </div>
      <br>
        
        <div style="text-align:center">
          <span class="dot" onclick="currentSlide(1)"></span> 
          <span class="dot" onclick="currentSlide(2)"></span> 
          <span class="dot" onclick="currentSlide(3)"></span> 
        </div>
        
      <div class="last-matches" id="last-matches">
        <div class="match-header-home">
          <h2 style="margin: 0; text-decoration: underline;">Your Last Matches</h2>
          <span>Filter:</span>
          <select id="selected-matchtype" name="matchtype">
            <option value="" selected>All Matches</option>
            <option value="competitive">Competitive</option>
            <option value="unrated">Unrated</option>
            <option value="deathmatch">Deathmatch</option>
            <option value="spikerush">Spike Rush</option>
            <option value="escalation">Escalation</option>
            <option value="replication">Replication</option>
          </select>
        </div>
        <hr id="lastElement" style="display: none;">
      </div>
      <div class="home-right-side">
        <div class="home-upper-right">
          <h2 style="margin-top: 0; text-decoration: underline;" id="home-stats-header">Stats of your last 5 Matches</h2>
          <ul class="last-5-matches-info">
            <li>AVG KDA:<span class="home-avg-kda"></span></li>
            <li>AVG Score:<span class="home-avg-score"></span></li>
            <li>AVG Dmg/Match:<span class="home-avg-dmg_match"></span></li>
            <br>
            <li>Headshot Percentage:<span class="home-avg-headshots"></span></li>
            <li>Bodyshot Percentage:<span class="home-avg-bodyshots"></span></li>
            <li>Legshot Percentage:<span class="home-avg-legshots"></span></li>
            <br>
            <li>RR Change: <span class="home-avg-rrchange"></span></li>
          </ul>
        </div>
        <div class="home-lower-right">
          <h2 style="margin-top: 0; text-decoration: underline;">Featured Bundle</h2>
          <div class="featured-bundle-wrapper">
            <img class="featured-bundle-img">
            <span class="featured-bundle-title"></span>
            <br><span class="featured-bundle-time-left"></span>
          </div>
        </div>
      </div>
    </div>

    <script>
      require('./renderer.js')
    </script>
    <script>
      window.onload = function() {
        if(sessionStorage.getItem("Update-downloaded") == true) {
          $('.update-banner').css("display", "block");
        }
        if(sessionStorage.getItem("Update-available") == true) {
          $('.download-banner').css("display", "block");
        }
      }
      // Listen for messages
      const { ipcRenderer } = require('electron');
        ipcRenderer.on('message', function(event, text) {
        console.log(text);
      })
      //Update downloaded
      ipcRenderer.on('showUpdateWindow', function(event) {
        sessionStorage.setItem("Update-downloaded", true);
        $('.download-banner').css("display", "none");
        $('.update-banner').css("display", "block");
      })
      //Update Found, about to download
      ipcRenderer.on('update-available', function(event, value) {
        sessionStorage.setItem("Update-available", true);
        $('.update-banner').css("display", "none");
        $('.download-banner').css("display", "block");
      })
      //Update downloading
      $('.download-bar').css("display", "block");
      ipcRenderer.on('download-percent', function(event, value) {
        $('.download-banner').css("display", "block");
        document.getElementById("download-bar").value = value
      })
      $('.update-relative-div').on("click", function() {
        $('.update-banner').css("display", "none");
      })
      $('#noti-close-button').on("click", function() {
        window.close()
      })
      $('.download-relative-div').on("click", function() {
        $('.download-banner').css("display", "none");
      })
    </script>

    <script type="application/javascript" src="assets/js/home/newsSlideAndUserGreeting.js"></script>
    <script type="application/javascript" src="assets/js/home/loadPlayerMatches.js"></script>
    <script type="application/javascript" src="assets/js/home/loadWebsiteNews.js"></script>
    <script type="application/javascript" src="assets/js/home/loadNewestBundleAndMatchFilter.js"></script>
    <script type="application/javascript" src="assets/js/home/loadPlayerStats.js"></script>
    <script type="application/javascript" src="assets/js/home/changePlayerMatchType.js"></script>
    <script type="application/javascript" src="assets/js/home/redirectToMatchview.js"></script>
    <script type="application/javascript" src="assets/js/navslideToggle.js"></script>
    <script type="application/javascript" src="assets/js/redirects.js"></script>
  </body>
</html>